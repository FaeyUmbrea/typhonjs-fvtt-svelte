{"version":3,"file":"index.js","sources":["../../../src/component/dialog/document/TJSDocumentCreate.svelte","../../../src/component/dialog/document/TJSDocumentDelete.svelte","../../../src/component/dialog/document/TJSDocumentImport.svelte","../../../src/component/dialog/document/TJSFolderCreateUpdate.svelte","../../../src/component/dialog/document/TJSFolderDelete.svelte","../../../src/component/dialog/document/TJSFolderExport.svelte","../../../src/component/dialog/document/TJSFolderRemove.svelte","../../../src/component/dialog/document/TJSFolderRolltable.svelte","../../../src/component/dialog/document/TJSPermissionControl.svelte"],"sourcesContent":["<script>\r\n   import { getContext }    from 'svelte';\r\n\r\n   import {\r\n      localize,\r\n      selectOptions }       from '@typhonjs-fvtt/svelte/helper';\r\n\r\n   export let documentCls = void 0;\r\n   export let data = {};\r\n   export let parent = null;\r\n   export let pack = null;\r\n   export let renderSheet = true;\r\n\r\n   const { application } = getContext('external');\r\n\r\n   let form;\r\n   let name, folderSelect, folders, hasTypes, type, types;\r\n\r\n   if (!Object.prototype.isPrototypeOf.call(foundry.abstract.Document, documentCls))\r\n   {\r\n      throw new TypeError(`TJSCreateDocument error: 'documentCls' is not a Document.`);\r\n   }\r\n\r\n   // Collect data\r\n   const documentName = documentCls.metadata.name;\r\n   const label = localize(documentCls.metadata.label);\r\n\r\n   folderSelect = data.folder || '';\r\n   folders = parent ? [] : game.folders.filter((f) => (f.data.type === documentName) && f.displayed);\r\n   types = game.system.documentTypes[documentName];\r\n\r\n   hasTypes = types.length > 1;\r\n\r\n   name = data.name || localize('DOCUMENT.New', { type: label });\r\n   type = data.type || types[0];\r\n\r\n   types = types.reduce((obj, t) =>\r\n   {\r\n      const typeLabel = CONFIG[documentName]?.typeLabels?.[t] ?? t;\r\n      obj[t] = game.i18n.has(typeLabel) ? localize(typeLabel) : t;\r\n      return obj;\r\n   }, {});\r\n\r\n   export function requestSubmit()\r\n   {\r\n      form.requestSubmit();\r\n   }\r\n\r\n   /**\r\n    * Creates a new document from the form data.\r\n    *\r\n    * @returns {Promise<void>}\r\n    */\r\n   async function saveData(event)\r\n   {\r\n      const fd = new FormDataExtended(event.target);\r\n\r\n      foundry.utils.mergeObject(data, fd.toObject(), { inplace: true });\r\n\r\n      if (!data.folder) { delete data['folder']; }\r\n      if (types.length === 1) { data.type = types[0]; }\r\n\r\n      const document = await documentCls.create(data, { parent, pack, renderSheet });\r\n\r\n      application.options.resolve?.(document);\r\n      application.close();\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<form bind:this={form} on:submit|preventDefault={saveData} id=\"document-create\" autocomplete=\"off\">\r\n   <div class=\"form-group\">\r\n      <label>{localize('Name')}</label>\r\n      <div class=\"form-fields\">\r\n         <input type=\"text\" name=\"name\" placeholder={name} required/>\r\n      </div>\r\n   </div>\r\n\r\n   {#if hasTypes}\r\n      <div class=\"form-group\">\r\n         <label>{localize('Type')}</label>\r\n         <div class=\"form-fields\">\r\n            <select name=\"type\">\r\n               {@html selectOptions(types, {selected: type})}\r\n            </select>\r\n         </div>\r\n      </div>\r\n   {/if}\r\n\r\n   {#if folders.length >= 1}\r\n      <div class=\"form-group\">\r\n         <label>{localize('DOCUMENT.Folder')}</label>\r\n         <div class=\"form-fields\">\r\n            <select name=\"folder\" bind:value={folderSelect}>\r\n               <option value=\"\"></option>\r\n               {#each folders as folder}\r\n                  <option value={folder.id}>{folder.name}</option>\r\n               {/each}\r\n            </select>\r\n         </div>\r\n      </div>\r\n   {/if}\r\n</form>\r\n","<script>\r\n   import { getContext }   from 'svelte';\r\n\r\n   import { localize }     from '@typhonjs-fvtt/svelte/helper';\r\n   import { TJSDocument }  from '@typhonjs-fvtt/svelte/store';\r\n\r\n   /** @type {foundry.abstract.Document} */\r\n   export let document = void 0;\r\n\r\n   /** @type {object} DocumentModificationContext */\r\n   export let context = {};\r\n\r\n   const { application } = getContext('external');\r\n\r\n   if (!(document instanceof foundry.abstract.Document))\r\n   {\r\n      throw new TypeError(`TJSDocumentDelete error: 'document' is not an instance of Document.`);\r\n   }\r\n\r\n   const doc = new TJSDocument(document, { delete: application.close.bind(application) });\r\n\r\n   let name = document?.id ? document.name : '';\r\n   let type = localize(document.constructor.metadata.label);\r\n\r\n   $: if (typeof context !== 'object')\r\n   {\r\n      throw new TypeError(`TJSDocumentDelete error: 'context' is not an object.`);\r\n   }\r\n\r\n   $: if ($doc !== document)\r\n   {\r\n      if (!(document instanceof foundry.abstract.Document))\r\n      {\r\n         throw new TypeError(`TJSDocumentDelete error: 'document' is not an instance of Document.`);\r\n      }\r\n\r\n      doc.set(document);\r\n\r\n      name = document?.id ? document.name : '';\r\n      type = localize(document.constructor.metadata.label);\r\n\r\n      application.data.set('title', `${localize('DOCUMENT.Delete', { type })}: ${document.name}`);\r\n   }\r\n\r\n   /**\r\n    * Handles the button click for 'Yes'.\r\n    *\r\n    * @returns {Promise<void>}\r\n    */\r\n   export async function deleteDocument()\r\n   {\r\n      // Remove the delete Document function callback as we are intentionally deleting below.\r\n      doc.setOptions({ delete: void 0 });\r\n\r\n      const returnDoc = await document.delete(context);\r\n\r\n      application.options.resolve?.(returnDoc);\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<h4>{localize('AreYouSure')}</h4>\r\n<p>{localize('SIDEBAR.DeleteWarning', { type })}</p>\r\n","<script>\r\n   import { getContext }   from 'svelte';\r\n\r\n   import { localize }     from '@typhonjs-fvtt/svelte/helper';\r\n   import { TJSDocument }  from '@typhonjs-fvtt/svelte/store';\r\n\r\n   /** @type {foundry.abstract.Document} */\r\n   export let document = void 0;\r\n\r\n   const { application } = getContext('external');\r\n\r\n   if (!(document instanceof foundry.abstract.Document))\r\n   {\r\n      throw new TypeError(`TJSDocumentImport error: 'document' is not an instance of Document.`);\r\n   }\r\n\r\n   const doc = new TJSDocument(document, { delete: application.close.bind(application) });\r\n\r\n   let form;\r\n\r\n   let hint1 = localize('DOCUMENT.ImportDataHint1', { document: document.documentName });\r\n   let hint2 = localize('DOCUMENT.ImportDataHint2', { name: document.name });\r\n\r\n   $: if ($doc !== document)\r\n   {\r\n      if (!(document instanceof foundry.abstract.Document))\r\n      {\r\n         throw new TypeError(`TJSDocumentImport error: 'document' is not an instance of Document.`);\r\n      }\r\n\r\n      doc.set(document);\r\n\r\n      hint1 = localize('DOCUMENT.ImportDataHint1', { document: document.documentName });\r\n      hint2 = localize('DOCUMENT.ImportDataHint2', { name: document.name });\r\n\r\n      application.data.set('title', `${localize('DOCUMENT.ImportData')}: ${document.name}`);\r\n   }\r\n\r\n   async function handleImport()\r\n   {\r\n      if (!form.data.files.length) { return ui.notifications.error('You did not upload a data file!'); }\r\n\r\n      const json = await readTextFromFile(form.data.files[0]);\r\n\r\n      const importedDoc = await document.importFromJSON(json);\r\n\r\n      application.options.resolve?.(importedDoc);\r\n      application.close();\r\n   }\r\n\r\n   export function requestSubmit()\r\n   {\r\n      form.requestSubmit();\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<form bind:this={form} on:submit|preventDefault={handleImport} autocomplete=off>\r\n    <p class=notes>{hint1}</p>\r\n    <p class=notes>{hint2}</p>\r\n    <div class=form-group>\r\n        <label for=data>{localize('DOCUMENT.ImportSource')}</label>\r\n        <input type=file id=data required />\r\n    </div>\r\n</form>\r\n","<script>\r\n   import { getContext }   from 'svelte';\r\n\r\n   import {\r\n      localize,\r\n      radioBoxes }         from '@typhonjs-fvtt/svelte/helper';\r\n\r\n   import { TJSDocument }  from '@typhonjs-fvtt/svelte/store';\r\n\r\n   export let document = void 0;\r\n\r\n   const s_REGEX_HEX_COLOR = /^#(?:[0-9a-fA-F]{3}){1,2}$/;\r\n\r\n   const { application } = getContext('external');\r\n\r\n   if (!(document instanceof Folder))\r\n   {\r\n      throw new TypeError(`TJSFolderCreateUpdate error: 'document' is not an instance of Folder.`);\r\n   }\r\n\r\n   const doc = new TJSDocument(document, { delete: application.close.bind(application) });\r\n   const newName = localize('DOCUMENT.New', { type: localize(Folder.metadata.label) });\r\n   const sortingModes = { a: 'FOLDER.SortAlphabetical', m: 'FOLDER.SortManual' };\r\n\r\n   let form;\r\n\r\n   let name = document?.id ? document.name : '';\r\n   let color = document?.data?.color;\r\n\r\n   let colorText = '';\r\n\r\n   $: if ($doc !== document)\r\n   {\r\n      if (!(document instanceof Folder))\r\n      {\r\n         throw new TypeError(`TJSFolderCreateUpdate error: 'document' is not an instance of Folder.`);\r\n      }\r\n\r\n      doc.set(document);\r\n\r\n      name = document?.id ? document.name : '';\r\n      color = document?.data?.color;\r\n\r\n      // Update the dialog button label and title.\r\n      application.data.merge({\r\n         buttons: {\r\n            submit: {\r\n               label: localize(document?.id ? 'FOLDER.Update' : 'FOLDER.Create')\r\n            }\r\n         },\r\n         title: document?.id ? `${localize('FOLDER.Update')}: ${document.name}` : localize('FOLDER.Create')\r\n      });\r\n   }\r\n\r\n   // Reactive block to test color and if it is not a valid hex color then reset colorText and set color to black.\r\n   $: if (s_REGEX_HEX_COLOR.test(color))\r\n   {\r\n      colorText = color;\r\n   }\r\n   else\r\n   {\r\n      colorText = null;\r\n      color = '#000000'\r\n   }\r\n\r\n   export function requestSubmit()\r\n   {\r\n      form.requestSubmit();\r\n   }\r\n\r\n   /**\r\n    * Saves any form data / changes to document.\r\n    *\r\n    * @returns {Promise<void>}\r\n    */\r\n   async function saveData(event)\r\n   {\r\n      const formData = new FormDataExtended(event.target).toObject();\r\n\r\n      if (!formData.parent) { formData.parent = null; }\r\n\r\n      let modifiedDoc = document;\r\n\r\n      if (document.id)\r\n      {\r\n         await document.update(formData);\r\n      }\r\n      else\r\n      {\r\n         document.data.update(formData);\r\n         modifiedDoc = await Folder.create(document.data);\r\n      }\r\n\r\n      application.options.resolve?.(modifiedDoc);\r\n      application.close();\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<form bind:this={form} on:submit|preventDefault={saveData} id=folder-create autocomplete=off>\r\n   <input type=hidden name=type value={document.data.type}/>\r\n   <input type=hidden name=parent value={document.data.parent}/>\r\n\r\n   <div class=form-group>\r\n      <label>{localize('FOLDER.Name')}</label>\r\n      <div class=form-fields>\r\n         <input type=text name=name placeholder={newName} value={name} required/>\r\n      </div>\r\n   </div>\r\n\r\n   <div class=form-group>\r\n      <label>{localize('FOLDER.Color')}</label>\r\n      <div class=form-fields>\r\n         <input type=text name=color bind:value={colorText} readonly />\r\n         <input type=color bind:value={color} data-edit=color />\r\n         <button type=button on:click={() => color = null}><i class=\"fas fa-trash-restore\"></i></button>\r\n      </div>\r\n   </div>\r\n\r\n   <div class=form-group>\r\n      <label>{localize('FOLDER.SortMode')}</label>\r\n      <div class=form-fields>\r\n         {@html radioBoxes('sorting', sortingModes, { checked: document.data.sorting, localize: true })}\r\n      </div>\r\n   </div>\r\n</form>\r\n","<script>\r\n   import { getContext }    from 'svelte';\r\n\r\n   import { localize }      from '@typhonjs-fvtt/svelte/helper';\r\n   import { TJSDocument }   from '@typhonjs-fvtt/svelte/store';\r\n\r\n   export let document = void 0;\r\n\r\n   const { application } = getContext('external');\r\n\r\n   if (!(document instanceof Folder))\r\n   {\r\n      throw new TypeError(`TJSFolderDelete error: 'document' is not an instance of Folder.`);\r\n   }\r\n\r\n   const doc = new TJSDocument(document, { delete: application.close.bind(application) });\r\n\r\n   $: if ($doc !== document)\r\n   {\r\n      if (!(document instanceof Folder))\r\n      {\r\n         throw new TypeError(`TJSFolderDelete error: 'document' is not an instance of Folder.`);\r\n      }\r\n\r\n      doc.set(document);\r\n\r\n      application.data.set('title', `${localize('FOLDER.Delete')}: ${document.name}`);\r\n   }\r\n\r\n   /**\r\n    * Removes a folder with deleting documents.\r\n    *\r\n    * @returns {Promise<Folder>}\r\n    */\r\n   export async function deleteFolder()\r\n   {\r\n      // Remove the delete Document function callback as we are intentionally deleting below.\r\n      doc.setOptions({ delete: void 0 });\r\n\r\n      const folder = await document.delete({ deleteSubfolders: true, deleteContents: true });\r\n\r\n      application.options.resolve?.(folder);\r\n      application.close();\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<h4>{localize('AreYouSure')}</h4>\r\n<p>{localize('FOLDER.DeleteWarning')}</p>\r\n","<script>\r\n   import { getContext }      from 'svelte';\r\n\r\n   import { localize }        from '@typhonjs-fvtt/svelte/helper';\r\n\r\n   import { TJSDocument }     from '@typhonjs-fvtt/svelte/store';\r\n\r\n   export let document = void 0;\r\n\r\n   export let packName;\r\n   export let merge;\r\n   export let keepId;\r\n\r\n   let selected;\r\n\r\n   $: packName = typeof packName === 'string' ? packName : void 0;\r\n   $: merge = typeof merge === 'boolean' ? merge : true;\r\n   $: keepId = typeof keepId === 'boolean' ? keepId : true;\r\n\r\n   const { application } = getContext('external');\r\n\r\n   if (!(document instanceof Folder))\r\n   {\r\n      throw new TypeError(`TJSFolderExport error: 'document' is not an instance of Folder.`);\r\n   }\r\n\r\n   const doc = new TJSDocument(document, { delete: application.close.bind(application) });\r\n\r\n   // Get eligible pack destinations\r\n   let packs = game.packs.filter(p => (p.documentName === document.type) && !p.locked);\r\n   if (!packs.length)\r\n   {\r\n      ui.notifications.warn(localize('FOLDER.ExportWarningNone', { type: document.type }));\r\n      application.options.resolve?.(null);\r\n      application.close();\r\n   }\r\n\r\n   selected = packs[0].metadata.name;\r\n\r\n   // Configure any default pack by ID search.\r\n   for (const pack of packs)\r\n   {\r\n      if (pack.title === packName) { selected = pack.metadata.name; }\r\n   }\r\n\r\n   $:\r\n   {\r\n      // Update the title if document name changes\r\n      application.data.set('title', `${localize('FOLDER.ExportTitle')}: ${$doc.name}`);\r\n   }\r\n\r\n   /**\r\n    * Export folder documents to compendium.\r\n    *\r\n    * @returns {Promise<CompendiumCollection|boolean>}\r\n    */\r\n   export async function exportData()\r\n   {\r\n      // Find the pack; maybe it has been deleted or locked\r\n      const pack = game.packs.find((p) => (p?.metadata?.package === 'world') && (p?.metadata?.name === selected));\r\n\r\n      if (pack instanceof CompendiumCollection && !pack?.locked)\r\n      {\r\n         await document.exportToCompendium(pack, {\r\n            updateByName: merge,\r\n            keepId\r\n         });\r\n\r\n         application.options.resolve?.(pack);\r\n      }\r\n      else\r\n      {\r\n         application.options.resolve?.(false);\r\n      }\r\n\r\n      application.close();\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<form on:submit|preventDefault={exportData} autocomplete=off>\r\n    <p class=notes>{localize('FOLDER.ExportHint')}</p>\r\n    <div class=form-group>\r\n        <label>{localize('FOLDER.ExportDestination')}</label>\r\n        <select name=pack bind:value={selected}>\r\n            {#each packs as pack (pack.id)}\r\n                <option value={pack.metadata.name}>{pack.title}</option>\r\n            {/each}\r\n        </select>\r\n    </div>\r\n    <div class=form-group>\r\n        <label>{localize('FOLDER.ExportMerge')}</label>\r\n        <input type=checkbox name=merge bind:checked={merge}/>\r\n    </div>\r\n    <div class=form-group>\r\n        <label>{localize('FOLDER.ExportKeepId')}</label>\r\n        <input type=checkbox name=keepId bind:checked={keepId}/>\r\n    </div>\r\n</form>\r\n","<script>\r\n   import { getContext }    from 'svelte';\r\n\r\n   import { localize }      from '@typhonjs-fvtt/svelte/helper';\r\n   import { TJSDocument }   from '@typhonjs-fvtt/svelte/store';\r\n\r\n   export let document = void 0;\r\n\r\n   const { application } = getContext('external');\r\n\r\n   if (!(document instanceof Folder))\r\n   {\r\n      throw new TypeError(`TJSFolderRemove error: 'document' is not an instance of Folder.`);\r\n   }\r\n\r\n   const doc = new TJSDocument(document, { delete: application.close.bind(application) });\r\n\r\n   $: if ($doc !== document)\r\n   {\r\n      if (!(document instanceof Folder))\r\n      {\r\n         throw new TypeError(`TJSFolderRemove error: 'document' is not an instance of Folder.`);\r\n      }\r\n\r\n      doc.set(document);\r\n\r\n      application.data.set('title', `${localize('FOLDER.Remove')}: ${document.name}`);\r\n   }\r\n\r\n   /**\r\n    * Removes a folder without deleting documents.\r\n    *\r\n    * @returns {Promise<Folder>}\r\n    */\r\n   export async function removeFolder()\r\n   {\r\n      // Remove the delete Document function callback as we are intentionally deleting below.\r\n      doc.setOptions({ delete: void 0 });\r\n\r\n      const folder = await document.delete({ deleteSubfolders: false, deleteContents: false });\r\n\r\n      application.options.resolve?.(folder);\r\n      application.close();\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<h4>{localize('AreYouSure')}</h4>\r\n<p>{localize('FOLDER.RemoveWarning')}</p>\r\n","<script>\r\n   import { getContext }      from 'svelte';\r\n\r\n   import { localize }        from '@typhonjs-fvtt/svelte/helper';\r\n   import { TJSDocument }     from '@typhonjs-fvtt/svelte/store';\r\n\r\n   export let document = void 0;\r\n\r\n   const { application } = getContext('external');\r\n\r\n   if (!(document instanceof Folder))\r\n   {\r\n      throw new TypeError(`TJSFolderRolltable error: 'document' is not an instance of Folder.`);\r\n   }\r\n\r\n   const doc = new TJSDocument(document, { delete: application.close.bind(application) });\r\n\r\n   $: if ($doc !== document)\r\n   {\r\n      if (!(document instanceof Folder))\r\n      {\r\n         throw new TypeError(`TJSFolderRolltable error: 'document' is not an instance of Folder.`);\r\n      }\r\n\r\n      doc.set(document);\r\n\r\n      application.data.set('title', `${localize('FOLDER.CreateTable')}: ${document.name}`);\r\n   }\r\n\r\n   /**\r\n    * Creates roll table from folder documents.\r\n    *\r\n    * @returns {Promise<RollTable>}\r\n    */\r\n   export async function createTable()\r\n   {\r\n      const rollTable = await RollTable.fromFolder(document);\r\n\r\n      application.options.resolve?.(rollTable);\r\n      application.close();\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n{localize('FOLDER.CreateTableConfirm')}\r\n","<script>\r\n   import { getContext }   from 'svelte';\r\n\r\n   import {\r\n      localize,\r\n      selectOptions }      from '@typhonjs-fvtt/svelte/helper';\r\n\r\n   import { TJSDocument }  from '@typhonjs-fvtt/svelte/store';\r\n\r\n   export let document = void 0;\r\n\r\n   const { application } = getContext('external');\r\n\r\n   if (!(document instanceof foundry.abstract.Document))\r\n   {\r\n      throw new TypeError(`TJSPermissionControl error: 'document' is not an instance of Document.`);\r\n   }\r\n\r\n   const doc = new TJSDocument(document, { delete: application.close.bind(application) });\r\n\r\n   let form, instructions;\r\n   let currentDefault, defaultLevels, playerLevels, users;\r\n   let isFolder = document instanceof Folder;\r\n\r\n   $: if ($doc !== document)\r\n   {\r\n      if (!(document instanceof foundry.abstract.Document))\r\n      {\r\n         throw new TypeError(`TJSPermissionControl error: 'document' is not an instance of Document.`);\r\n      }\r\n\r\n      doc.set(document);\r\n\r\n      const title = localize('PERMISSION.Title');\r\n\r\n      application.data.set('title', `${title}: ${document.name}`);\r\n   }\r\n\r\n   $: {\r\n      ({ currentDefault, defaultLevels, playerLevels, users } = getData());\r\n      isFolder = $doc instanceof Folder;\r\n      instructions = localize(isFolder ? 'PERMISSION.HintFolder' : 'PERMISSION.HintDocument');\r\n   }\r\n\r\n   /**\r\n    * Builds the data for the permission dialog from the document.\r\n    */\r\n   function getData()\r\n   {\r\n      // User permission levels\r\n      const playerLevels = {};\r\n      if (isFolder)\r\n      {\r\n         playerLevels['-2'] = localize('PERMISSION.DEFAULT');\r\n         playerLevels['-1'] = localize('PERMISSION.NOCHANGE');\r\n      }\r\n      else\r\n      {\r\n         playerLevels['-1'] = localize('PERMISSION.DEFAULT');\r\n      }\r\n\r\n      for (const [n, l] of Object.entries(CONST.DOCUMENT_PERMISSION_LEVELS))\r\n      {\r\n         playerLevels[l] = localize(`PERMISSION.${n}`);\r\n      }\r\n\r\n      // Default permission levels\r\n      const defaultLevels = foundry.utils.deepClone(playerLevels);\r\n\r\n      if (isFolder) { delete defaultLevels['-2']; }\r\n      else { delete defaultLevels['-1']; }\r\n\r\n      // Player users\r\n      const users = game.users.map((u) =>\r\n      {\r\n         return {\r\n            user: u,\r\n            level: $doc.data.permission?.[u.id] ?? '-1'\r\n         };\r\n      });\r\n\r\n      // Construct and return the data object\r\n      return {\r\n         currentDefault: $doc.data.permission?.default ?? '-1',\r\n         defaultLevels,\r\n         playerLevels,\r\n         users\r\n      };\r\n   }\r\n\r\n   export function requestSubmit()\r\n   {\r\n      form.requestSubmit();\r\n   }\r\n\r\n   /**\r\n    * Saves any form data / changes to document.\r\n    *\r\n    * @returns {Promise<void>}\r\n    */\r\n   async function saveData(event)\r\n   {\r\n      if (!($doc instanceof foundry.abstract.Document)) { return; }\r\n\r\n      const formData = new FormDataExtended(event.target).toObject();\r\n\r\n      // Collect user permissions\r\n      const perms = {};\r\n      for (const [user, level] of Object.entries(formData))\r\n      {\r\n         if (level === -1)\r\n         {\r\n            delete perms[user];\r\n            continue;\r\n         }\r\n         perms[user] = level;\r\n      }\r\n\r\n      // Update all documents in a Folder\r\n      if ($doc instanceof Folder)\r\n      {\r\n         const cls = getDocumentClass($doc.type);\r\n         const updates = $doc.content.map((e) =>\r\n         {\r\n            const p = foundry.utils.deepClone(e.data.permission);\r\n            for (const [k, v] of Object.entries(perms))\r\n            {\r\n               if (v === -2) { delete p[k]; }\r\n               else { p[k] = v; }\r\n            }\r\n            return { _id: e.id, permission: p };\r\n         });\r\n\r\n         await cls.updateDocuments(updates, { diff: false, recursive: false, noHook: true });\r\n\r\n         application.options.resolve?.($doc);\r\n         application.close();\r\n      }\r\n\r\n      // Update a single Document\r\n      await $doc.update({ permission: perms }, { diff: false, recursive: false, noHook: true });\r\n\r\n      application.options.resolve?.($doc);\r\n      application.close();\r\n   }\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<form bind:this={form} on:submit|preventDefault={saveData} id=permission-control>\r\n   <p class=notes>{instructions}</p>\r\n\r\n   <div class=form-group>\r\n      <label>{localize('PERMISSION.AllPlayers')}</label>\r\n      <select name=default data-dtype=Number>\r\n         {@html selectOptions(defaultLevels, { selected: currentDefault })}\r\n      </select>\r\n   </div>\r\n   <hr/>\r\n\r\n   {#each users as data (data.user.id)}\r\n      <div class=form-group class:hidden={data.user.isGM}>\r\n         <label>{data.user.name}</label>\r\n            <select name={data.user.id} data-dtype=Number>\r\n               {@html selectOptions(playerLevels, { selected: data.level })}\r\n            </select>\r\n        </div>\r\n    {/each}\r\n</form>\r\n"],"names":[],"mappings":"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"}