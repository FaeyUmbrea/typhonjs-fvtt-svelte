function noop(){}function run(t){return t()}function blank_object(){return Object.create(null)}function run_all(t){t.forEach(run)}function is_function(t){return"function"==typeof t}function safe_not_equal(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function append(t,e){t.appendChild(e)}function detach(t){t.parentNode.removeChild(t)}function element(t){return document.createElement(t)}function attr(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let t;function set_current_component(e){t=e}const e=[],n=[],o=[],r=[],i=Promise.resolve();let s=0;function add_render_callback(t){o.push(t)}let c=0;const l=new Set;function flush(){if(!c){c=1;do{for(let t=0;t<e.length;t+=1){const n=e[t];set_current_component(n),update(n.$$)}for(set_current_component(null),e.length=0;n.length;)n.pop()();for(let t=0;t<o.length;t+=1){const e=o[t];l.has(e)||(l.add(e),e())}o.length=0}while(e.length);for(;r.length;)r.pop()();s=0,c=0,l.clear()}}function update(t){if(null!==t.fragment){t.update(),run_all(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(add_render_callback)}}const a=new Set;function localize(t,e){const n="object"!=typeof e?game.i18n.localize(t):game.i18n.format(t,e);return void 0!==n?n:""}function create_fragment(t){let e,n,o,r,i,s,c,l=localize(t[0].label)+"";return{c(){var s;e=element("a"),n=element("i"),s=l,i=document.createTextNode(s),attr(n,"class",o=t[0].icon),attr(n,"title",r=localize(t[0].title)),attr(e,"class","header-button")},m(o,r){var l,a,u,p;!function(t,e,n){t.insertBefore(e,n||null)}(o,e,r),append(e,n),append(e,i),s||(l=e,a="click",u=t[1],l.addEventListener(a,u,p),c=()=>l.removeEventListener(a,u,p),s=1)},p(t,[e]){var s,c;1&e&&o!==(o=t[0].icon)&&attr(n,"class",o),1&e&&r!==(r=localize(t[0].title))&&attr(n,"title",r),1&e&&l!==(l=localize(t[0].label)+"")&&(c=""+(c=l),(s=i).wholeText!==c&&(s.data=c))},i:noop,o:noop,d(t){t&&detach(e),s=0,c()}}}function instance(e,n,o){let{button:r}=n;return i=()=>{console.log("HeaderButton.svelte - onDestroy")},function(){if(!t)throw new Error("Function called outside component initialization");return t}().$$.on_destroy.push(i),e.$$set=t=>{"button"in t&&o(0,r=t.button)},[r,function(){"function"==typeof r.onclick&&(r.onclick.call(r),o(0,r))}];var i}class HeaderButton extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(run_all(n.on_destroy),n.fragment&&n.fragment.d(1),n.on_destroy=n.fragment=null,n.ctx=[])}(this),this.$destroy=noop}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=1,this.$$set(t),this.$$.skip_bound=0)}}{constructor(n){super(),function(n,o,r,c,l,u,p,f=[-1]){const d=t;set_current_component(n);const h=n.$$={fragment:null,ctx:null,props:u,update:noop,not_equal:l,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(d?d.$$.context:[])),callbacks:blank_object(),dirty:f,skip_bound:0,root:o.target||d.$$.root};p&&p(h.root);let _=0;if(h.ctx=r?r(n,o.props||{},((t,o,...r)=>{const c=r.length?r[0]:o;return h.ctx&&l(h.ctx[t],h.ctx[t]=c)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](c),_&&function(t,n){-1===t.$$.dirty[0]&&(e.push(t),s||(s=1,i.then(flush)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}(n,t)),o})):[],h.update(),_=1,run_all(h.before_update),h.fragment=c?c(h.ctx):0,o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);h.fragment&&h.fragment.l(t),t.forEach(detach)}else h.fragment&&h.fragment.c();o.intro&&(m=n.$$.fragment)&&m.i&&(a.delete(m),m.i(void 0)),function(t,e,n,o){const{fragment:r,on_mount:i,on_destroy:s,after_update:c}=t.$$;r&&r.m(e,n),o||add_render_callback((()=>{const e=i.map(run).filter(is_function);s?s.push(...e):run_all(e),t.$$.on_mount=[]})),c.forEach(add_render_callback)}(n,o.target,o.anchor,o.customElement),flush()}var m;set_current_component(d)}(this,n,instance,create_fragment,safe_not_equal,{button:0})}}class SvelteApplication extends Application{constructor(t){super(t),this._svelteComponents=[]}async close(t={}){const e=Application.RENDER_STATES;if(!t.force&&![e.RENDERED,e.ERROR].includes(this._state))return;this._state=e.CLOSING;const n=this.element;if(!n)return this._state=e.CLOSED;n.css({minHeight:0});for(const t of this.constructor._getInheritanceChain())Hooks.call(`close${t.name}`,this,n);return new Promise((t=>{n.slideUp(200,(()=>{for(const t of this._svelteComponents)t.component?.$destroy();this._svelteComponents=[],n.remove(),this._element=null,delete ui.windows[this.appId],this._minimized=0,this._scrollPositions=null,this._state=e.CLOSED,t()}))}))}_injectHTML(t){if(this.popOut&&0===t.length&&Array.isArray(this.options.svelte))throw new Error("SvelteApplication - _injectHTML - A popout app with no template can only support one Svelte component.");if(Array.isArray(this.options.svelte))for(const e of this.options.svelte)this._svelteComponents.push(s_LOAD_CONFIG(this,t,e));else{if("object"!=typeof this.options.svelte)throw new TypeError("SvelteApplication - _injectHTML - this.options.svelte not an array or object.");this._svelteComponents.push(s_LOAD_CONFIG(this,t,this.options.svelte))}const e=t.length&&t[0]instanceof DocumentFragment&&t[0].firstElementChild,n=e?$(t[0].firstElementChild):void 0;super._injectHTML(t),e&&(this._element=n),this.onSvelteMount(this.element)}onSvelteMount(t){}_replaceHTML(t,e){t.length&&this.popOut&&t.find(".window-title").text(this.title)}async _renderInner(t){const e="string"==typeof this.template?await renderTemplate(this.template,t):document.createDocumentFragment();return $(e)}}function s_LOAD_CONFIG(t,e,n){const o="object"==typeof n.options?n.options:{},r="boolean"==typeof o.injectApp?o.injectApp:0,i="string"==typeof t.template,s="string"==typeof n.target;if("function"!=typeof n.class)throw new TypeError(`SvelteApplication - s_LOAD_CONFIG - class not a constructor for config:\n${JSON.stringify(n)}.`);if(i&&!s)throw new TypeError(`SvelteApplication - s_LOAD_CONFIG - target selector not a string for config:\n${JSON.stringify(n)}`);const c=s?e.find(n.target).get(0):document.createDocumentFragment();if(void 0===c)throw new Error(`SvelteApplication - s_LOAD_CONFIG - could not find target selector: ${n.target} for config:\n${JSON.stringify(n)}`);const l=n.class,a={...n,target:c};r&&("object"!=typeof a.props&&(a.props={}),a.props._foundryApp=t);const u={config:a,component:new l(a)};return s||e.append(c),u}export{HeaderButton,SvelteApplication};
//# sourceMappingURL=index.js.map
